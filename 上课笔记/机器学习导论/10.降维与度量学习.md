## 降维与度量学习

### 低维嵌入

```
假定降维之后，低维下的欧式距离等于高维距离
```

设原空间的距离矩阵为 $D$ , 每一个元素记作 $dist_{ij}$

那么有
$$
||z_i-z_j||=dist_{ij}
$$
且假设降维之后的矩阵 $Z$ 已经被中心化。那么有
$$
b_{ij}=-\frac12(dist{ij}-dist{i.}-dist{.j+dist{..}})
$$
其中

$dist_{.j}=\frac1m\sum_{i=1}^mdist_{ij}$

$dist_{..}=\frac1{m^2}\sum_{i=1}^m\sum_{j=1}^mdist{i,j}$

然后对矩阵 $B=V \Lambda V$ 进行特征值分解，选取
$$
\begin{align}
B&=V \Lambda V^T\\
&=V \Lambda^{1/2} (V \Lambda^{1/2} )^T
\end{align}
$$
则 $V \Lambda ^{1/2} \in R^{m\times d'}$ 是低维下的坐标

```
如上称为 MDS 算法
```

### PCA 主成分分析

假设样本集合 $D=\{x_1,x_2,...,x_m\}$

1. 将样本进行中心化 

$$
x_i=x_i-mean(x_i)
$$

2. 计算协方差矩阵$XX^T$

3. 对协方差矩阵进行特征值分解，得到最大的 $d'$ 个特征值对应的特征向量 $w _i,w_2 ,...,,w_{d'}$ 
4. 投影矩阵 $W=(w_1,w_2,...w_{d'}) \in R^{d\times d'}$ , 新坐标 $W^TX \in R^{d'\times m}$

### 等度量映射

ISO Map

主要的算法内容和 **MDS** 算法类似，而获取距离矩阵$D$的方式不同 .

需要添加一个 $ k$ 近邻的参数，首先计算 $x_i$ 和它的 $k$ 近邻之间的 **欧氏距离** ， 然后调用最短路径算法，获取整个距离矩阵，作为 **MDS** 算法

### 局部线性嵌入

保持降维前后的，和近邻之间的线性关系

1. 寻找 $x_i $ 的近邻下标集合 $Q_i$， 基于下标集合中的点，得到 **线性重构系数** $w_i$

$$
\begin{align}
\min_{w_1,w_2,...w_m}&\sum_{i=1}^m||x_i-\sum_{j\in Q_i}w_{ij}x_j||^2_2\\
s.t.&\sum_{j\in Q_i}w_{ij}=1
\end{align}
$$

对于 $j \notin Q_i$ , 设定 $w_{ij} = 0$

2. 计算

$$
M=(I-W)^T(I-W)
$$

3. 对 $M$ 矩阵进行特征值分解，得到 **最小** 的$d'$ 个特征值对应的特征向量，即为投影向量